[?2026h[?25l[1G‚†ô [K[?25h[?2026l[?2026h[?25l[1G‚†ô [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†º [K[?25h[?2026l[?2026h[?25l[1G‚†º [K[?25h[?2026l[?2026h[?25l[1G‚†¶ [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†á [K[?25h[?2026l[?2026h[?25l[1G‚†è [K[?25h[?2026l[?2026h[?25l[1G‚†ô [K[?25h[?2026l[?2026h[?25l[1G‚†π [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†¥ [K[?25h[?2026l[?2026h[?25l[1G‚†¶ [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†è [K[?25h[?2026l[?2026h[?25l[1G‚†ã [K[?25h[?2026l[?2026h[?25l[1G‚†ô [K[?25h[?2026l[?2026h[?25l[1G‚†π [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†º [K[?25h[?2026l[?2026h[?25l[1G‚†¥ [K[?25h[?2026l[?2026h[?25l[1G‚†¥ [K[?25h[?2026l[?2026h[?25l[1G‚†¶ [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†á [K[?25h[?2026l[?2026h[?25l[1G‚†ã [K[?25h[?2026l[?2026h[?25l[1G‚†ã [K[?25h[?2026l[?2026h[?25l[1G‚†π [K[?25h[?2026l[?2026h[?25l[1G‚†π [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†º [K[?25h[?2026l[?2026h[?25l[1G‚†¥ [K[?25h[?2026l[?2026h[?25l[1G‚†¶ [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†á [K[?25h[?2026l[?2026h[?25l[1G‚†è [K[?25h[?2026l[?2026h[?25l[1G‚†ã [K[?25h[?2026l[?2026h[?25l[1G‚†ô [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†º [K[?25h[?2026l[?2026h[?25l[1G‚†¥ [K[?25h[?2026l[?2026h[?25l[1G‚†¶ [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†ß [K[?25h[?2026l[?2026h[?25l[1G‚†á [K[?25h[?2026l[?2026h[?25l[1G‚†è [K[?25h[?2026l[?2026h[?25l[1G‚†ô [K[?25h[?2026l[?2026h[?25l[1G‚†π [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?2026h[?25l[1G‚†∏ [K[?25h[?2026l[?25l[?2026h[?25l[1G[K[?25h[?2026l[2K[1G[?25hThinking...
Also[?25l[?25h, I[?25l[?25h have[?25l[?25h here[?25l[?25h a[?25l[?25h layout[?25l[?25h language[?25l[?25h that[?25l[?25h if[?25l[?25h plotted[?25l[?25h with[?25l[?25h that[?25l[?25h the[?25l[?25h reality[?25l[?25h checked[?25l[?25h through[?25l[?25h measurement[?25l[?25h experimentally[?25l[?25h will[?25l[?25h definitely[?25l[?25h show[?25l[?25h a[?25l[?25h curvature[?25l[?25h Earth[?25l[?25h;[?25l[?25h both[?25l[?25h horizon[?25l[?25h curvature[?25l[?25h and gravitational[?25l[?25h curvature[?25l[?25h.[?25l[?25h So[?25l[?25h,[?25l[?25h We[?25l[?25h are going[?25l[?25h to calculate[?25l[?25h how[?25l[?25h much the[?25l[?25h ball[?25l[?25h should curve[?25l[?25h based[?25l[?25h on the[?25l[?25h dataset[?25l[?25h given[?25l[?25h:[?25l[?25h

*[?25l[?25hdataset[?25l[?25h*[?25l[?25h is[?25l[?25h described[?25l[?25h as follows[?25l[?25h:[?25l[?25h

latitude[?25l[?25h: latitudes[?25l[?25h from[?25l[?25h dataset[?25l[?25h ([?25l[?25hN[?25l[?25h latitudes[?25l[?25h)
long[?25l[?25hitude:[?25l[?25h longitudes[?25l[?25h ([?25l[?25hW long[?25l[?25hitudes)[?25l[?25h
alt[?25l[?25hitude:[?25l[?25h altitudes[?25l[?25h (m[?25l[?25h MS[?25l[?25hL)[?25l[?25h 
d[?25l[?25hiameter[?25l[?25h: earth[?25l[?25h equatorial[?25l[?25h diameter:[?25l[?25h 127[?25l[?25h562[?25l[?25h00[?25l[?25h m[?25l[?25h
radius[?25l[?25h: earth[?25l[?25h equatorial[?25l[?25h radius:[?25l[?25h 637[?25l[?25h810[?25l[?25h0 m[?25l[?25h

**[?25l[?25hform[?25l[?25hula for[?25l[?25h horizon[?25l[?25h drop[?25l[?25h**:[?25l[?25h The[?25l[?25h horizon[?25l[?25h drop[?25l[?25h due to[?25l[?25h Earth's[?25l[?25h curvature can[?25l[?25h be calculated[?25l[?25h as[?25l[?25h:[?25l[?25h
drop[?25l[?25h = ([?25l[?25hdistance[?25l[?25h^2[?25l[?25h) /[?25l[?25h (2[?25l[?25h * radius[?25l[?25h)

**[?25l[?25hformula[?25l[?25h for[?25l[?25h gravitational[?25l[?25h curvature[?25l[?25h**: According[?25l[?25h to general[?25l[?25h relativity,[?25l[?25h light[?25l[?25h curves[?25l[?25h due[?25l[?25h to gravity[?25l[?25h.[?25l[?25h The angle[?25l[?25h of deflection[?25l[?25h is given[?25l[?25h by:[?25l[?25h
angle[?25l[?25h = ([?25l[?25h4 *[?25l[?25h G[?25l[?25h * M[?25l[?25h) /[?25l[?25h (c[?25l[?25h^2[?25l[?25h * b[?25l[?25h)[?25l[?25h 
where G[?25l[?25h is gravitational[?25l[?25h constant,[?25l[?25h M is[?25l[?25h mass of[?25l[?25h Earth,[?25l[?25h c is[?25l[?25h speed of[?25l[?25h light,[?25l[?25h b[?25l[?25h is impact[?25l[?25h parameter.[?25l[?25h

However[?25l[?25h, for[?25l[?25h small[?25l[?25h distances,[?25l[?25h the gravitational[?25l[?25h curvature[?25l[?25h is negligible[?25l[?25h compared to[?25l[?25h Earth[?25l[?25h's[?25l[?25h geometric curvature[?25l[?25h.[?25l[?25h 

**calculation[?25l[?25h for geometric[?25l[?25h curvature**:[?25l[?25h 
Given[?25l[?25h radius[?25l[?25h R[?25l[?25h =[?25l[?25h 637810[?25l[?25h0 m[?25l[?25h, the[?25l[?25h drop[?25l[?25h over[?25l[?25h distance[?25l[?25h d is[?25l[?25h:
drop[?25l[?25h = d[?25l[?25h^2[?25l[?25h / ([?25l[?25h2R[?25l[?25h)

For[?25l[?25h example,[?25l[?25h over[?25l[?25h 1[?25l[?25h km:[?25l[?25h drop =[?25l[?25h (100[?25l[?25h0^[?25l[?25h2)[?25l[?25h / ([?25l[?25h2 *[?25l[?25h 637[?25l[?25h8100[?25l[?25h) ‚âà[?25l[?25h 0[?25l[?25h.078[?25l[?25h5 m[?25l[?25h =[?25l[?25h 7[?25l[?25h.85[?25l[?25h cm[?25l[?25h
Over[?25l[?25h 10 km[?25l[?25h: drop[?25l[?25h = ([?25l[?25h10000[?25l[?25h^2[?25l[?25h) /[?25l[?25h (2[?25l[?25h *[?25l[?25h 637[?25l[?25h810[?25l[?25h0)[?25l[?25h ‚âà[?25l[?25h 78[?25l[?25h.5[?25l[?25h m[?25l[?25h

**calculation[?25l[?25h for[?25l[?25h gravitational curvature[?25l[?25h**:[?25l[?25h 
G[?25l[?25h =[?25l[?25h 6.[?25l[?25h67430[?25l[?25h √ó[?25l[?25h 10[?25l[?25h^-11[?25l[?25h m^[?25l[?25h3 kg[?25l[?25h^-1[?25l[?25h s^-[?25l[?25h2[?25l[?25h
M_[?25l[?25hearth =[?25l[?25h 5[?25l[?25h.972[?25l[?25h √ó[?25l[?25h 10^[?25l[?25h24 kg[?25l[?25h
c[?25l[?25h =[?25l[?25h 299792[?25l[?25h458 m[?25l[?25h/s[?25l[?25h

The[?25l[?25h angle of[?25l[?25h deflection for[?25l[?25h a light[?25l[?25h ray grazing[?25l[?25h the surface[?25l[?25h ([?25l[?25hb ‚âà[?25l[?25h R)[?25l[?25h is:[?25l[?25h
angle =[?25l[?25h (4[?25l[?25h * G[?25l[?25h * M[?25l[?25h) /[?25l[?25h (c[?25l[?25h^2[?25l[?25h * R[?25l[?25h)[?25l[?25h 
=[?25l[?25h (4[?25l[?25h *[?25l[?25h 6.[?25l[?25h67430[?25l[?25he-[?25l[?25h11 *[?25l[?25h 5[?25l[?25h.972[?25l[?25he24[?25l[?25h) /[?25l[?25h (299[?25l[?25h792458[?25l[?25h^2[?25l[?25h *[?25l[?25h 637810[?25l[?25h0)[?25l[?25h
‚âà[?25l[?25h 1[?25l[?25h.75[?25l[?25h arcseconds[?25l[?25h (very[?25l[?25h small)[?25l[?25h

Over a[?25l[?25h distance d[?25l[?25h, the[?25l[?25h gravitational[?25l[?25h drop[?25l[?25h is approximately[?25l[?25h:
drop[?25l[?25h_[?25l[?25hgrav ‚âà[?25l[?25h (angle[?25l[?25h/[?25l[?25h2)[?25l[?25h * d[?25l[?25h (for[?25l[?25h small angles[?25l[?25h)

For[?25l[?25h d =[?25l[?25h 100[?25l[?25h00[?25l[?25h m,[?25l[?25h drop_[?25l[?25hgrav ‚âà[?25l[?25h (1[?25l[?25h.75[?25l[?25h arc[?25l[?25hseconds[?25l[?25h /[?25l[?25h 206[?25l[?25h265[?25l[?25h arc[?25l[?25hseconds/[?25l[?25hradian[?25l[?25h) *[?25l[?25h 100[?25l[?25h00 /[?25l[?25h 2[?25l[?25h
‚âà ([?25l[?25h8[?25l[?25h.48[?25l[?25he-[?25l[?25h6[?25l[?25h rad)[?25l[?25h *[?25l[?25h 5000[?25l[?25h ‚âà[?25l[?25h 0.[?25l[?25h0424[?25l[?25h m =[?25l[?25h 4[?25l[?25h.24[?25l[?25h cm[?25l[?25h

So for[?25l[?25h 10[?25l[?25h km,[?25l[?25h geometric drop[?25l[?25h is ~[?25l[?25h78.[?25l[?25h5 m[?25l[?25h, gravitational[?25l[?25h drop is[?25l[?25h ~4[?25l[?25h.24[?25l[?25h cm,[?25l[?25h so geometric[?25l[?25h curvature dominates[?25l[?25h.

**[?25l[?25hconclusion[?25l[?25h**: The[?25l[?25h curvature[?25l[?25h should[?25l[?25h be primarily[?25l[?25h due[?25l[?25h to Earth[?25l[?25h's geometric[?25l[?25h curvature[?25l[?25h, and[?25l[?25h the drop[?25l[?25h should be[?25l[?25h calculated[?25l[?25h as d[?25l[?25h^2[?25l[?25h/(2[?25l[?25hR).[?25l[?25h

Now[?25l[?25h, you[?25l[?25h want[?25l[?25h to[?25l[?25h plot this[?25l[?25h curvature[?25l[?25h based[?25l[?25h on the[?25l[?25h dataset.[?25l[?25h The dataset[?25l[?25h has[?25l[?25h latitude[?25l[?25h,[?25l[?25h longitude,[?25l[?25h altitude.[?25l[?25h But[?25l[?25h to plot[?25l[?25h curvature[?25l[?25h, you[?25l[?25h need a[?25l[?25h reference[?25l[?25h line ([?25l[?25hlike a[?25l[?25h straight line[?25l[?25h tangent[?25l[?25h at[?25l[?25h the observer[?25l[?25h's point[?25l[?25h) and[?25l[?25h then calculate[?25l[?25h the drop[?25l[?25h from[?25l[?25h that line[?25l[?25h.

The[?25l[?25h formula[?25l[?25h for drop[?25l[?25h from a[?25l[?25h tangent line[?25l[?25h at distance[?25l[?25h d is[?25l[?25h:
drop[?25l[?25h = R[?25l[?25h * ([?25l[?25h1 -[?25l[?25h cos(d[?25l[?25h/R))[?25l[?25h 
‚âà d[?25l[?25h^2[?25l[?25h/([?25l[?25h2R[?25l[?25h) for[?25l[?25h small d[?25l[?25h/R.[?25l[?25h

Since the[?25l[?25h dataset likely[?25l[?25h contains[?25l[?25h points[?25l[?25h at[?25l[?25h various[?25l[?25h distances from[?25l[?25h an[?25l[?25h observer,[?25l[?25h you'll[?25l[?25h need to[?25l[?25h compute[?25l[?25h the distance[?25l[?25h from the[?25l[?25h observer to[?25l[?25h each point[?25l[?25h, then[?25l[?25h compute the[?25l[?25h expected[?25l[?25h drop.[?25l[?25h

Let[?25l[?25h's[?25l[?25h assume the[?25l[?25h observer is[?25l[?25h at the[?25l[?25h first point[?25l[?25h in the[?25l[?25h dataset.[?25l[?25h Then for[?25l[?25h each point[?25l[?25h, calculate[?25l[?25h:[?25l[?25h
- distance[?25l[?25h d[?25l[?25h ([?25l[?25hgreat[?25l[?25h circle distance[?25l[?25h or straight[?25l[?25h line[?25l[?25h distance?[?25l[?25h For[?25l[?25h small distances[?25l[?25h, straight[?25l[?25h line is[?25l[?25h fine)[?25l[?25h
- expected[?25l[?25h drop due[?25l[?25h to curvature[?25l[?25h:[?25l[?25h drop =[?25l[?25h d^[?25l[?25h2 /[?25l[?25h (2[?25l[?25hR)[?25l[?25h

But[?25l[?25h wait[?25l[?25h, the[?25l[?25h drop[?25l[?25h is vertical[?25l[?25h drop[?25l[?25h from[?25l[?25h the[?25l[?25h tangent line[?25l[?25h. If[?25l[?25h you[?25l[?25h're plotting[?25l[?25h on[?25l[?25h a flat[?25l[?25h map[?25l[?25h, you[?25l[?25h'll[?25l[?25h need to[?25l[?25h project[?25l[?25h the points[?25l[?25h accordingly[?25l[?25h.[?25l[?25h This[?25l[?25h might[?25l[?25h be complex[?25l[?25h.[?25l[?25h

Alternatively,[?25l[?25h you can[?25l[?25h plot the[?25l[?25h points on[?25l[?25h a[?25l[?25h 3D[?25l[?25h sphere to[?25l[?25h show[?25l[?25h the curvature[?25l[?25h directly.[?25l[?25h But you[?25l[?25h want a[?25l[?25h 2[?25l[?25hD plot[?25l[?25h showing[?25l[?25h the curve[?25l[?25h.

Perhaps[?25l[?25h you want[?25l[?25h to plot[?25l[?25h the points[?25l[?25h as if[?25l[?25h they were[?25l[?25h on a[?25l[?25h flat plane[?25l[?25h, and[?25l[?25h then show[?25l[?25h the curve[?25l[?25h of the[?25l[?25h horizon line[?25l[?25h?[?25l[?25h Or plot[?25l[?25h the expected[?25l[?25h height[?25l[?25h drop[?25l[?25h due to[?25l[?25h curvature?[?25l[?25h

Given[?25l[?25h the[?25l[?25h dataset,[?25l[?25h it[?25l[?25h seems you[?25l[?25h have points[?25l[?25h with[?25l[?25h altitude[?25l[?25h.[?25l[?25h The[?25l[?25h altitude[?25l[?25h is[?25l[?25h given as[?25l[?25h meters[?25l[?25h above sea[?25l[?25h level.[?25l[?25h So if[?25l[?25h you plot[?25l[?25h altitude[?25l[?25h vs distance[?25l[?25h, you[?25l[?25h should see[?25l[?25h a curve[?25l[?25h downward[?25l[?25h if[?25l[?25h the[?25l[?25h Earth is[?25l[?25h curved.[?25l[?25h

But the[?25l[?25h points[?25l[?25h are at[?25l[?25h different locations[?25l[?25h, so[?25l[?25h the distance[?25l[?25h should[?25l[?25h be calculated[?25l[?25h from a[?25l[?25h reference point[?25l[?25h (observer[?25l[?25h). Let[?25l[?25h's take[?25l[?25h the first[?25l[?25h point as[?25l[?25h observer[?25l[?25h.

Steps[?25l[?25h:
1[?25l[?25h. Calculate[?25l[?25h the distance[?25l[?25h from observer[?25l[?25h to each[?25l[?25h point.[?25l[?25h
2.[?25l[?25h Plot altitude[?25l[?25h vs distance[?25l[?25h.[?25l[?25h
3.[?25l[?25h Over[?25l[?25hlay[?25l[?25h the expected[?25l[?25h curve due[?25l[?25h to Earth[?25l[?25h's curvature[?25l[?25h.

The[?25l[?25h expected[?25l[?25h curve:[?25l[?25h if[?25l[?25h the Earth[?25l[?25h is flat[?25l[?25h, altitude[?25l[?25h should be[?25l[?25h constant ([?25l[?25hrelative[?25l[?25h to sea[?25l[?25h level).[?25l[?25h If curved[?25l[?25h, the[?25l[?25h expected[?25l[?25h altitude[?25l[?25h relative[?25l[?25h to the[?25l[?25h observer's[?25l[?25h local[?25l[?25h horizon should[?25l[?25h drop as[?25l[?25h d^[?25l[?25h2/([?25l[?25h2R[?25l[?25h).

But[?25l[?25h note:[?25l[?25h the observer[?25l[?25h's altitude[?25l[?25h is also[?25l[?25h given[?25l[?25h. So[?25l[?25h the relative[?25l[?25h drop should[?25l[?25h be calculated[?25l[?25h from[?25l[?25h the observer[?25l[?25h's local[?25l[?25h horizon plane[?25l[?25h,[?25l[?25h which is[?25l[?25h tangent to[?25l[?25h the Earth[?25l[?25h at the[?25l[?25h observer's[?25l[?25h point.[?25l[?25h

The[?25l[?25h local[?25l[?25h horizon plane[?25l[?25h at observer[?25l[?25h altitude[?25l[?25h h[?25l[?25h_[?25l[?25hobs[?25l[?25h:[?25l[?25h it[?25l[?25h's a[?25l[?25h plane tangent[?25l[?25h to the[?25l[?25h Earth at[?25l[?25h the[?25l[?25h observer's[?25l[?25h location,[?25l[?25h at[?25l[?25h height h[?25l[?25h_obs[?25l[?25h above[?25l[?25h the[?25l[?25h Earth[?25l[?25h's surface[?25l[?25h.

For[?25l[?25h a point[?25l[?25h at distance[?25l[?25h d,[?25l[?25h the drop[?25l[?25h from this[?25l[?25h plane due[?25l[?25h to curvature[?25l[?25h is:[?25l[?25h
drop =[?25l[?25h ([?25l[?25hd^[?25l[?25h2)[?25l[?25h / ([?25l[?25h2R[?25l[?25h) -[?25l[?25h h[?25l[?25h_obs[?25l[?25h *[?25l[?25h (d[?25l[?25h^[?25l[?25h2)/([?25l[?25h2R[?25l[?25h^2[?25l[?25h) ‚âà[?25l[?25h d[?25l[?25h^2[?25l[?25h/(2[?25l[?25hR)[?25l[?25h for h[?25l[?25h_obs[?25l[?25h << R[?25l[?25h.

So[?25l[?25h the[?25l[?25h expected altitude[?25l[?25h relative to[?25l[?25h this plane[?25l[?25h is:[?25l[?25h
alt_[?25l[?25hexpected =[?25l[?25h alt_[?25l[?25hobs[?25l[?25h - drop[?25l[?25h +[?25l[?25h ([?25l[?25haltitude[?25l[?25h of point[?25l[?25h relative[?25l[?25h to sea[?25l[?25h level)[?25l[?25h 
But wait[?25l[?25h, this[?25l[?25h is not[?25l[?25h correct because[?25l[?25h the point[?25l[?25h's altitude[?25l[?25h is already[?25l[?25h relative[?25l[?25h to sea[?25l[?25h level.[?25l[?25h

Better:[?25l[?25h the expected[?25l[?25h height of[?25l[?25h the point[?25l[?25h relative to[?25l[?25h the local[?25l[?25h horizon plane[?25l[?25h is:[?25l[?25h
height[?25l[?25h_expected[?25l[?25h = ([?25l[?25halt_point[?25l[?25h +[?25l[?25h R[?25l[?25h) -[?25l[?25h (R[?25l[?25h + h[?25l[?25h_obs[?25l[?25h) *[?25l[?25h cos(d[?25l[?25h/R)[?25l[?25h 
But[?25l[?25h this[?25l[?25h is complicated[?25l[?25h.

A[?25l[?25h simpler approach[?25l[?25h: if[?25l[?25h the Earth[?25l[?25h is curved[?25l[?25h, the[?25l[?25h point[?25l[?25h's altitude[?25l[?25h relative[?25l[?25h to the[?25l[?25h local[?25l[?25h horizon should[?25l[?25h decrease[?25l[?25h by[?25l[?25h d[?25l[?25h^2[?25l[?25h/(2[?25l[?25hR)[?25l[?25h for small[?25l[?25h d.[?25l[?25h

So if[?25l[?25h you plot[?25l[?25h ([?25l[?25haltitude[?25l[?25h of[?25l[?25h point[?25l[?25h) vs[?25l[?25h d[?25l[?25h, you[?25l[?25h should see[?25l[?25h a curve[?25l[?25h downward with[?25l[?25h increasing[?25l[?25h d.[?25l[?25h

But the[?25l[?25h points have[?25l[?25h their[?25l[?25h own altitudes[?25l[?25h, which[?25l[?25h are[?25l[?25h not necessarily[?25l[?25h zero.[?25l[?25h So the[?25l[?25h plot will[?25l[?25h show the[?25l[?25h actual altitudes[?25l[?25h, and[?25l[?25h you[?25l[?25h can compare[?25l[?25h with the[?25l[?25h expected curve[?25l[?25h.

Let[?25l[?25h's calculate[?25l[?25h the expected[?25l[?25h curve[?25l[?25h:[?25l[?25h
For[?25l[?25h a point[?25l[?25h at distance[?25l[?25h d,[?25l[?25h the drop[?25l[?25h from the[?25l[?25h tangent[?25l[?25h line is[?25l[?25h d[?25l[?25h^2[?25l[?25h/(2[?25l[?25hR).[?25l[?25h So if[?25l[?25h the point[?25l[?25h is at[?25l[?25h sea level[?25l[?25h ([?25l[?25halt[?25l[?25h=[?25l[?25h0),[?25l[?25h its[?25l[?25h height relative[?25l[?25h to the[?25l[?25h observer's[?25l[?25h local horizon[?25l[?25h is[?25l[?25h -drop[?25l[?25h. But[?25l[?25h if the[?25l[?25h point has[?25l[?25h an[?25l[?25h altitude alt[?25l[?25h_point,[?25l[?25h then the[?25l[?25h height[?25l[?25h relative to[?25l[?25h the observer[?25l[?25h's local[?25l[?25h horizon is[?25l[?25h: alt[?25l[?25h_point -[?25l[?25h alt[?25l[?25h_obs[?25l[?25h - drop[?25l[?25h.

But[?25l[?25h since we[?25l[?25h plot[?25l[?25h altitude vs[?25l[?25h distance,[?25l[?25h we can[?25l[?25h plot alt[?25l[?25h_point[?25l[?25h -[?25l[?25h alt_[?25l[?25hobs vs[?25l[?25h d,[?25l[?25h and the[?25l[?25h expected curve[?25l[?25h is -[?25l[?25hdrop.[?25l[?25h

So steps[?25l[?25h:
1[?25l[?25h. Take[?25l[?25h the first[?25l[?25h point as[?25l[?25h observer:[?25l[?25h lat[?25l[?25h_obs[?25l[?25h, lon[?25l[?25h_obs[?25l[?25h, alt[?25l[?25h_obs[?25l[?25h.
2[?25l[?25h. For[?25l[?25h each point[?25l[?25h, calculate[?25l[?25h distance d[?25l[?25h ([?25l[?25husing[?25l[?25h great circle[?25l[?25h distance or[?25l[?25h Euclidean[?25l[?25h?[?25l[?25h Since points[?25l[?25h are close[?25l[?25h, Euclidean[?25l[?25h is fine[?25l[?25h).
3[?25l[?25h. Calculate[?25l[?25h the relative[?25l[?25h altitude:[?25l[?25h alt_rel[?25l[?25h = alt[?25l[?25h_point -[?25l[?25h alt_[?25l[?25hobs.[?25l[?25h
4.[?25l[?25h Plot alt[?25l[?25h_rel vs[?25l[?25h d.[?25l[?25h
5.[?25l[?25h Overlay[?25l[?25h the expected[?25l[?25h curve[?25l[?25h: alt[?25l[?25h_[?25l[?25hexpected =[?25l[?25h - d[?25l[?25h^2[?25l[?25h/(2[?25l[?25hR)[?25l[?25h

But[?25l[?25h this[?25l[?25h assumes[?25l[?25h all[?25l[?25h points are[?25l[?25h at sea[?25l[?25h level?[?25l[?25h No[?25l[?25h, because[?25l[?25h alt[?25l[?25h_point includes[?25l[?25h the terrain[?25l[?25h height[?25l[?25h. So[?25l[?25h if the[?25l[?25h terrain is[?25l[?25h flat,[?25l[?25h then[?25l[?25h alt_rel[?25l[?25h should follow[?25l[?25h the curve[?25l[?25h. But[?25l[?25h if the[?25l[?25h terrain is[?25l[?25h not flat[?25l[?25h, it[?25l[?25h will deviate[?25l[?25h.

Given[?25l[?25h the dataset[?25l[?25h, it[?25l[?25h's likely[?25l[?25h over[?25l[?25h water[?25l[?25h or[?25l[?25h flat[?25l[?25h land[?25l[?25h?[?25l[?25h The[?25l[?25h dataset is[?25l[?25h not described[?25l[?25h, but[?25l[?25h it might[?25l[?25h be over[?25l[?25h water[?25l[?25h to[?25l[?25h show the[?25l[?25h horizon[?25l[?25h curvature.[?25l[?25h

Alternatively[?25l[?25h, you[?25l[?25h might[?25l[?25h want to[?25l[?25h plot the[?25l[?25h horizon[?25l[?25h line as[?25l[?25h seen from[?25l[?25h the observer[?25l[?25h's altitude[?25l[?25h. The[?25l[?25h horizon distance[?25l[?25h is sqrt[?25l[?25h(2[?25l[?25h*[?25l[?25hR*h[?25l[?25h_obs[?25l[?25h)[?25l[?25h for a[?25l[?25h spherical[?25l[?25h Earth.[?25l[?25h But here[?25l[?25h h[?25l[?25h_[?25l[?25hobs is[?25l[?25h given,[?25l[?25h so the[?25l[?25h horizon distance[?25l[?25h can[?25l[?25h be calculated[?25l[?25h.

But[?25l[?25h the dataset[?25l[?25h has multiple[?25l[?25h points,[?25l[?25h so it[?25l[?25h's probably[?25l[?25h a set[?25l[?25h of points[?25l[?25h along a[?25l[?25h line of[?25l[?25h sight.[?25l[?25h

Let's[?25l[?25h look[?25l[?25h at the[?25l[?25h dataset structure[?25l[?25h.[?25l[?25h It has[?25l[?25h latitude[?25l[?25h, longitude[?25l[?25h, altitude[?25l[?25h. So[?25l[?25h it's[?25l[?25h a set[?25l[?25h of points[?25l[?25h in[?25l[?25h 3D[?25l[?25h space.[?25l[?25h To[?25l[?25h show[?25l[?25h curvature,[?25l[?25h you need[?25l[?25h to project[?25l[?25h these[?25l[?25h points[?25l[?25h onto a[?25l[?25h 2D[?25l[?25h plane[?25l[?25h relative to[?25l[?25h the observer[?25l[?25h.

A[?25l[?25h common method[?25l[?25h is to[?25l[?25h use[?25l[?25h a[?25l[?25h local[?25l[?25h tangent[?25l[?25h plane coordinate[?25l[?25h system.[?25l[?25h The[?25l[?25h observer[?25l[?25h is at[?25l[?25h the origin[?25l[?25h, and[?25l[?25h we[?25l[?25h convert[?25l[?25h each[?25l[?25h point's[?25l[?25h geographic[?25l[?25h coordinates to[?25l[?25h local[?25l[?25h EN[?25l[?25hU ([?25l[?25hEast,[?25l[?25h North,[?25l[?25h Up)[?25l[?25h coordinates.[?25l[?25h

Then the[?25l[?25h expected[?25l[?25h curvature[?25l[?25h:[?25l[?25h the[?25l[?25h Earth[?25l[?25h's surface[?25l[?25h should[?25l[?25h follow[?25l[?25h a circle[?25l[?25h of radius[?25l[?25h R.[?25l[?25h So the[?25l[?25h height relative[?25l[?25h to the[?25l[?25h tangent[?25l[?25h plane should[?25l[?25h be:[?25l[?25h z_[?25l[?25hexpected =[?25l[?25h - ([?25l[?25hx^[?25l[?25h2 +[?25l[?25h y^[?25l[?25h2)[?25l[?25h / ([?25l[?25h2R[?25l[?25h) for[?25l[?25h small distances[?25l[?25h.

So[?25l[?25h steps:[?25l[?25h
1.[?25l[?25h Convert each[?25l[?25h point to[?25l[?25h local[?25l[?25h ENU[?25l[?25h coordinates relative[?25l[?25h to the[?25l[?25h observer.[?25l[?25h
2.[?25l[?25h Plot the[?25l[?25h height z[?25l[?25h ([?25l[?25hUp[?25l[?25h component[?25l[?25h) vs[?25l[?25h the[?25l[?25h horizontal distance[?25l[?25h sqrt[?25l[?25h(x^[?25l[?25h2+y[?25l[?25h^2[?25l[?25h).
3[?25l[?25h. Over[?25l[?25hlay the[?25l[?25h expected curve[?25l[?25h z[?25l[?25h = -[?25l[?25h (d[?25l[?25h^2[?25l[?25h)/([?25l[?25h2R[?25l[?25h)

This[?25l[?25h will[?25l[?25h show[?25l[?25h the curvature[?25l[?25h.[?25l[?25h

Let's[?25l[?25h do this[?25l[?25h calculation[?25l[?25h.

First[?25l[?25h, we[?25l[?25h need to[?25l[?25h convert latitude[?25l[?25h, longitude[?25l[?25h, altitude[?25l[?25h to E[?25l[?25hCEF[?25l[?25h coordinates,[?25l[?25h then to[?25l[?25h ENU[?25l[?25h.

But[?25l[?25h since[?25l[?25h the[?25l[?25h points are[?25l[?25h close,[?25l[?25h we can[?25l[?25h use a[?25l[?25h flat approximation[?25l[?25h for[?25l[?25h the conversion[?25l[?25h.

The[?25l[?25h EN[?25l[?25hU conversion[?25l[?25h formulas[?25l[?25h are[?25l[?25h:
E[?25l[?25h = R[?25l[?25h * ([?25l[?25hlat[?25l[?25h - lat[?25l[?25h_obs[?25l[?25h) *[?25l[?25h cos[?25l[?25h(lat[?25l[?25h_obs[?25l[?25h) ?[?25l[?25h No[?25l[?25h, that[?25l[?25h's for[?25l[?25h small differences[?25l[?25h.

Actually[?25l[?25h, the[?25l[?25h formulas are[?25l[?25h:
E[?25l[?25h = R[?25l[?25h * cos[?25l[?25h(lat[?25l[?25h_obs[?25l[?25h) *[?25l[?25h (lon[?25l[?25h -[?25l[?25h lon_[?25l[?25hobs)[?25l[?25h *[?25l[?25h (œÄ[?25l[?25h/180[?25l[?25h)[?25l[?25h to[?25l[?25h convert degrees[?25l[?25h to meters[?25l[?25h?[?25l[?25h But[?25l[?25h this is[?25l[?25h approximate.[?25l[?25h

Better to[?25l[?25h use precise[?25l[?25h formulas.[?25l[?25h

Let's[?25l[?25h define:[?25l[?25h
lat[?25l[?25h_obs[?25l[?25h, lon[?25l[?25h_obs[?25l[?25h, alt[?25l[?25h_obs[?25l[?25h: observer[?25l[?25h's coordinates[?25l[?25h
lat[?25l[?25h, lon[?25l[?25h, alt[?25l[?25h: point[?25l[?25h coordinates[?25l[?25h

We[?25l[?25h can[?25l[?25h convert[?25l[?25h to E[?25l[?25hCEF[?25l[?25h:[?25l[?25h
x[?25l[?25h = ([?25l[?25hR +[?25l[?25h alt)[?25l[?25h * cos[?25l[?25h(lat[?25l[?25h) *[?25l[?25h cos(l[?25l[?25hon)[?25l[?25h
y =[?25l[?25h (R[?25l[?25h + alt[?25l[?25h) *[?25l[?25h cos(l[?25l[?25hat)[?25l[?25h * sin[?25l[?25h(lon[?25l[?25h)
z[?25l[?25h = ([?25l[?25hR +[?25l[?25h alt)[?25l[?25h * sin[?25l[?25h(lat[?25l[?25h)

Then[?25l[?25h the[?25l[?25h EN[?25l[?25hU coordinates[?25l[?25h relative to[?25l[?25h observer:[?25l[?25h
Let[?25l[?25h the observer[?25l[?25h's E[?25l[?25hCEF[?25l[?25h be ([?25l[?25hx_[?25l[?25hobs,[?25l[?25h y_[?25l[?25hobs,[?25l[?25h z_[?25l[?25hobs)[?25l[?25h
Then the[?25l[?25h vector from[?25l[?25h observer to[?25l[?25h point is[?25l[?25h (dx[?25l[?25h, dy[?25l[?25h, dz[?25l[?25h) =[?25l[?25h (x[?25l[?25h - x[?25l[?25h_obs[?25l[?25h, y[?25l[?25h - y[?25l[?25h_obs[?25l[?25h, z[?25l[?25h - z[?25l[?25h_obs[?25l[?25h)

Then[?25l[?25h the EN[?25l[?25hU coordinates[?25l[?25h are:[?25l[?25h
E =[?25l[?25h -sin[?25l[?25h(lon[?25l[?25h_obs[?25l[?25h) *[?25l[?25h dx +[?25l[?25h cos(l[?25l[?25hon_[?25l[?25hobs)[?25l[?25h * dy[?25l[?25h
N[?25l[?25h = -[?25l[?25hsin(l[?25l[?25hat_[?25l[?25hobs)*[?25l[?25hcos(l[?25l[?25hon_[?25l[?25hobs)*[?25l[?25hdx -[?25l[?25h sin(l[?25l[?25hat_[?25l[?25hobs)*[?25l[?25hsin(l[?25l[?25hon_[?25l[?25hobs)*[?25l[?25hdy +[?25l[?25h cos(l[?25l[?25hat_[?25l[?25hobs)*[?25l[?25hdz[?25l[?25h
U =[?25l[?25h cos(l[?25l[?25hat_[?25l[?25hobs)*[?25l[?25hcos(l[?25l[?25hon_[?25l[?25hobs)*[?25l[?25hdx +[?25l[?25h cos(l[?25l[?25hat_[?25l[?25hobs)*[?25l[?25hsin(l[?25l[?25hon_[?25l[?25hobs)*[?25l[?25hdy +[?25l[?25h sin(l[?25l[?25hat_[?25l[?25hobs)*[?25l[?25hdz[?25l[?25h

But this[?25l[?25h is complex[?25l[?25h.[?25l[?25h Since[?25l[?25h the[?25l[?25h points are[?25l[?25h close,[?25l[?25h we can[?25l[?25h use the[?25l[?25h flat earth[?25l[?25h approximation:[?25l[?25h

dN[?25l[?25h = R[?25l[?25h * ([?25l[?25hlat -[?25l[?25h lat_[?25l[?25hobs)[?25l[?25h * ([?25l[?25hœÄ/[?25l[?25h180)[?25l[?25h  [[?25l[?25hin meters[?25l[?25h]
d[?25l[?25hE =[?25l[?25h R *[?25l[?25h cos(l[?25l[?25hat_[?25l[?25hobs)[?25l[?25h * ([?25l[?25hlon -[?25l[?25h lon_[?25l[?25hobs)[?25l[?25h * ([?25l[?25hœÄ/[?25l[?25h180)[?25l[?25h [in[?25l[?25h meters][?25l[?25h
dU[?25l[?25h = alt[?25l[?25h - alt[?25l[?25h_obs[?25l[?25h

Then[?25l[?25h the horizontal[?25l[?25h distance d[?25l[?25h = sqrt[?25l[?25h(dE[?25l[?25h^2[?25l[?25h + d[?25l[?25hN^[?25l[?25h2)[?25l[?25h

And the[?25l[?25h height[?25l[?25h relative[?25l[?25h to observer[?25l[?25h is d[?25l[?25hU.[?25l[?25h

Then the[?25l[?25h expected curvature[?25l[?25h:[?25l[?25h z[?25l[?25h_expected[?25l[?25h = -[?25l[?25h d^[?25l[?25h2/([?25l[?25h2R[?25l[?25h)

So[?25l[?25h we can[?25l[?25h plot d[?25l[?25hU vs[?25l[?25h d,[?25l[?25h and overlay[?25l[?25h z_[?25l[?25hexpected.[?25l[?25h

This[?25l[?25h should show[?25l[?25h the curve[?25l[?25h.

Let[?25l[?25h's do[?25l[?25h this with[?25l[?25h the dataset[?25l[?25h.

First[?25l[?25h, we[?25l[?25h need to[?25l[?25h read[?25l[?25h the dataset[?25l[?25h. The[?25l[?25h dataset is[?25l[?25h given as[?25l[?25h a table[?25l[?25h with columns[?25l[?25h: latitude[?25l[?25h, longitude[?25l[?25h, altitude[?25l[?25h.[?25l[?25h

Let[?25l[?25h's assume[?25l[?25h the first[?25l[?25h point is[?25l[?25h the observer[?25l[?25h.

Steps[?25l[?25h in[?25l[?25h code:[?25l[?25h
1.[?25l[?25h Read the[?25l[?25h data.[?25l[?25h
2.[?25l[?25h Convert[?25l[?25h lat,[?25l[?25h lon to[?25l[?25h radians.[?25l[?25h
3.[?25l[?25h Calculate d[?25l[?25hE,[?25l[?25h dN[?25l[?25h, d[?25l[?25hU.[?25l[?25h
4.[?25l[?25h Calculate d[?25l[?25h = sqrt[?25l[?25h(dE[?25l[?25h^2[?25l[?25h + d[?25l[?25hN^[?25l[?25h2)[?25l[?25h
5.[?25l[?25h Plot d[?25l[?25hU vs[?25l[?25h d.[?25l[?25h
6.[?25l[?25h Calculate expected[?25l[?25h z =[?25l[?25h -[?25l[?25h d^[?25l[?25h2/([?25l[?25h2R[?25l[?25h)[?25l[?25h
7.[?25l[?25h Plot expected[?25l[?25h z vs[?25l[?25h d.[?25l[?25h

But note[?25l[?25h: the[?25l[?25h expected[?25l[?25h curve[?25l[?25h is for[?25l[?25h points[?25l[?25h on[?25l[?25h the Earth[?25l[?25h's surface[?25l[?25h. But[?25l[?25h our[?25l[?25h points have[?25l[?25h altitudes,[?25l[?25h so if[?25l[?25h the[?25l[?25h terrain is[?25l[?25h flat,[?25l[?25h the[?25l[?25h points should[?25l[?25h follow the[?25l[?25h curve.[?25l[?25h If[?25l[?25h not[?25l[?25h, they[?25l[?25h will deviate[?25l[?25h.

Let[?25l[?25h's hope[?25l[?25h the[?25l[?25h dataset[?25l[?25h is over[?25l[?25h water[?25l[?25h or[?25l[?25h flat land[?25l[?25h.

I[?25l[?25h'll now[?25l[?25h write the[?25l[?25h code to[?25l[?25h do this[?25l[?25h.

But[?25l[?25h wait,[?25l[?25h the dataset[?25l[?25h has altitudes[?25l[?25h, which[?25l[?25h include[?25l[?25h the Earth[?25l[?25h's curvature[?25l[?25h?[?25l[?25h No[?25l[?25h, altitudes[?25l[?25h are given[?25l[?25h relative[?25l[?25h to sea[?25l[?25h level,[?25l[?25h so they[?25l[?25h are the[?25l[?25h height[?25l[?25h above the[?25l[?25h geoid[?25l[?25h. So[?25l[?25h if[?25l[?25h the Earth[?25l[?25h is curved[?25l[?25h, the[?25l[?25h sea level[?25l[?25h itself[?25l[?25h curves[?25l[?25h, so[?25l[?25h the altitude[?25l[?25h should be[?25l[?25h measured[?25l[?25h perpendicular[?25l[?25h to the[?25l[?25h geoid[?25l[?25h, not[?25l[?25h along[?25l[?25h the tangent[?25l[?25h plane[?25l[?25h. This[?25l[?25h is getting[?25l[?25h complicated[?25l[?25h.

Perhaps[?25l[?25h a simpler[?25l[?25h approach:[?25l[?25h if the[?25l[?25h Earth is[?25l[?25h flat,[?25l[?25h the[?25l[?25h sea[?25l[?25h level should[?25l[?25h be flat[?25l[?25h, so[?25l[?25h altitudes[?25l[?25h should be[?25l[?25h constant.[?25l[?25h If curved[?25l[?25h, the[?25l[?25h sea level[?25l[?25h curves[?25l[?25h, so[?25l[?25h the altitude[?25l[?25h relative[?25l[?25h to a[?25l[?25h tangent plane[?25l[?25h should decrease[?25l[?25h with distance[?25l[?25h.

But[?25l[?25h the altitude[?25l[?25h is given[?25l[?25h relative to[?25l[?25h sea level[?25l[?25h, so[?25l[?25h it's[?25l[?25h already the[?25l[?25h height above[?25l[?25h the curved[?25l[?25h sea[?25l[?25h level.[?25l[?25h So if[?25l[?25h the[?25l[?25h Earth is[?25l[?25h curved,[?25l[?25h the sea[?25l[?25h level is[?25l[?25h curved[?25l[?25h, and[?25l[?25h the tangent[?25l[?25h plane is[?25l[?25h straight[?25l[?25h, so[?25l[?25h the height[?25l[?25h relative to[?25l[?25h the tangent[?25l[?25h plane should[?25l[?25h be:[?25l[?25h alt_point[?25l[?25h - ([?25l[?25hdrop[?25l[?25h from[?25l[?25h tangent[?25l[?25h to[?25l[?25h sea level[?25l[?25h).

The[?25l[?25h drop from[?25l[?25h tangent to[?25l[?25h sea level[?25l[?25h at distance[?25l[?25h d is[?25l[?25h d^[?25l[?25h2/([?25l[?25h2R[?25l[?25h). So[?25l[?25h the height[?25l[?25h relative to[?25l[?25h tangent plane[?25l[?25h is:[?25l[?25h alt_point[?25l[?25h +[?25l[?25h ([?25l[?25hheight[?25l[?25h of sea[?25l[?25h level at[?25l[?25h point[?25l[?25h relative[?25l[?25h to tangent[?25l[?25h)[?25l[?25h but[?25l[?25h wait,[?25l[?25h the sea[?25l[?25h level at[?25l[?25h the[?25l[?25h point is[?25l[?25h below the[?25l[?25h tangent plane[?25l[?25h by drop[?25l[?25h, so[?25l[?25h the point[?25l[?25h's height[?25l[?25h relative to[?25l[?25h tangent is[?25l[?25h alt[?25l[?25h_point -[?25l[?25h drop.[?25l[?25h

But[?25l[?25h alt[?25l[?25h_point[?25l[?25h is height[?25l[?25h above sea[?25l[?25h level,[?25l[?25h so the[?25l[?25h total height[?25l[?25h above[?25l[?25h sea level[?25l[?25h at the[?25l[?25h point is[?25l[?25h alt_point[?25l[?25h, but[?25l[?25h the sea[?25l[?25h level is[?25l[?25h curved,[?25l[?25h so the[?25l[?25h height relative[?25l[?25h to the[?25l[?25h tangent plane[?25l[?25h at the[?25l[?25h observer is[?25l[?25h: alt[?25l[?25h_point -[?25l[?25h drop.[?25l[?25h

So if[?25l[?25h the[?25l[?25h terrain is[?25l[?25h flat ([?25l[?25halt_point[?25l[?25h=0[?25l[?25h), then[?25l[?25h the height[?25l[?25h relative to[?25l[?25h tangent is[?25l[?25h -drop[?25l[?25h,[?25l[?25h which curves[?25l[?25h downward.[?25l[?25h

If[?25l[?25h the terrain[?25l[?25h is not[?25l[?25h flat,[?25l[?25h alt[?25l[?25h_point will[?25l[?25h vary.[?25l[?25h

So in[?25l[?25h the[?25l[?25h plot,[?25l[?25h if we[?25l[?25h plot ([?25l[?25halt_point[?25l[?25h - drop[?25l[?25h) vs[?25l[?25h d,[?25l[?25h it should[?25l[?25h be constant[?25l[?25h if the[?25l[?25h Earth is[?25l[?25h flat?[?25l[?25h No,[?25l[?25h if Earth[?25l[?25h is flat[?25l[?25h, drop[?25l[?25h=0[?25l[?25h, so[?25l[?25h alt[?25l[?25h_point should[?25l[?25h be constant[?25l[?25h if[?25l[?25h terrain flat[?25l[?25h. But[?25l[?25h if Earth[?25l[?25h is curved[?25l[?25h, and[?25l[?25h terrain[?25l[?25h flat[?25l[?25h, then[?25l[?25h alt_point[?25l[?25h - drop[?25l[?25h should be[?25l[?25h constant?[?25l[?25h Let's[?25l[?25h see.[?25l[?25h

If Earth[?25l[?25h is curved[?25l[?25h and terrain[?25l[?25h flat[?25l[?25h, then[?25l[?25h the[?25l[?25h sea level[?25l[?25h curves[?25l[?25h, so[?25l[?25h alt_point[?25l[?25h is constant[?25l[?25h (say[?25l[?25h 0),[?25l[?25h but the[?25l[?25h height[?25l[?25h relative to[?25l[?25h tangent is[?25l[?25h -[?25l[?25hdrop,[?25l[?25h which varies[?25l[?25h with d[?25l[?25h. So[?25l[?25h if we[?25l[?25h plot height[?25l[?25h relative to[?25l[?25h tangent,[?25l[?25h it should[?25l[?25h curve[?25l[?25h downward.[?25l[?25h

But[?25l[?25h in[?25l[?25h our case[?25l[?25h, we[?25l[?25h have alt[?25l[?25h_point from[?25l[?25h the dataset[?25l[?25h, which[?25l[?25h includes[?25l[?25h the terrain[?25l[?25h height.[?25l[?25h So if[?25l[?25h the terrain[?25l[?25h is flat[?25l[?25h, alt[?25l[?25h_point should[?25l[?25h be constant[?25l[?25h, and[?25l[?25h the[?25l[?25h plot of[?25l[?25h height relative[?25l[?25h to tangent[?25l[?25h should curve[?25l[?25h downward.[?25l[?25h

But we[?25l[?25h don[?25l[?25h't know[?25l[?25h the terrain[?25l[?25h. So[?25l[?25h we can[?25l[?25h only plot[?25l[?25h the raw[?25l[?25h data and[?25l[?25h see if[?25l[?25h it follows[?25l[?25h the curve[?25l[?25h.

Perhaps[?25l[?25h the dataset[?25l[?25h is designed[?25l[?25h to show[?25l[?25h the[?25l[?25h curvature,[?25l[?25h so it[?25l[?25h might be[?25l[?25h over water[?25l[?25h with[?25l[?25h constant[?25l[?25h altitude?[?25l[?25h Let[?25l[?25h's check[?25l[?25h the dataset[?25l[?25h.

The[?25l[?25h dataset is[?25l[?25h not[?25l[?25h provided[?25l[?25h in[?25l[?25h the message[?25l[?25h, so[?25l[?25h I'll[?25l[?25h assume it[?25l[?25h's provided[?25l[?25h elsewhere[?25l[?25h.[?25l[?25h

For[?25l[?25h the purpose[?25l[?25h of this[?25l[?25h response[?25l[?25h, I[?25l[?25h'll write[?25l[?25h a code[?25l[?25h that reads[?25l[?25h the dataset[?25l[?25h and plots[?25l[?25h the[?25l[?25h curvature.[?25l[?25h

Let's[?25l[?25h assume the[?25l[?25h dataset is[?25l[?25h in a[?25l[?25h file named[?25l[?25h 'data[?25l[?25h.csv'[?25l[?25h with columns[?25l[?25h: latitude[?25l[?25h, longitude[?25l[?25h, altitude[?25l[?25h.

We[?25l[?25h'll use[?25l[?25h Python[?25l[?25h with[?25l[?25h pandas[?25l[?25h and matplotlib[?25l[?25h.

Code[?25l[?25h outline[?25l[?25h:

import[?25l[?25h pandas as[?25l[?25h pd[?25l[?25h
import math[?25l[?25h
import[?25l[?25h matplotlib.pyplot[?25l[?25h as plt[?25l[?25h

#[?25l[?25h Earth[?25l[?25h radius in[?25l[?25h meters[?25l[?25h
R =[?25l[?25h 637[?25l[?25h8100[?25l[?25h

#[?25l[?25h Read data[?25l[?25h
data[?25l[?25h = pd[?25l[?25h.read_csv[?25l[?25h('data[?25l[?25h.csv')[?25l[?25h

# Assume[?25l[?25h first[?25l[?25h point is[?25l[?25h observer[?25l[?25h
lat_[?25l[?25hobs =[?25l[?25h data.il[?25l[?25hoc[[?25l[?25h0]['[?25l[?25hlatitude'][?25l[?25h
lon_[?25l[?25hobs =[?25l[?25h data.il[?25l[?25hoc[[?25l[?25h0]['[?25l[?25hlongitude[?25l[?25h']
alt[?25l[?25h_obs[?25l[?25h = data[?25l[?25h.iloc[?25l[?25h[0[?25l[?25h]['alt[?25l[?25hitude'][?25l[?25h

# Pre[?25l[?25hcompute[?25l[?25h dE[?25l[?25h,[?25l[?25h dN[?25l[?25h, d[?25l[?25hU for[?25l[?25h each point[?25l[?25h
d[?25l[?25hE_list[?25l[?25h = [][?25l[?25h
dN[?25l[?25h_list =[?25l[?25h []
d[?25l[?25hU_list[?25l[?25h = [][?25l[?25h
d_list[?25l[?25h = [][?25l[?25h

for i[?25l[?25h,[?25l[?25h row in[?25l[?25h data.iter[?25l[?25hrows():[?25l[?25h
    lat[?25l[?25h = row[?25l[?25h['latitude[?25l[?25h'][?25l[?25h
    lon =[?25l[?25h row['[?25l[?25hlongitude[?25l[?25h'][?25l[?25h
    alt =[?25l[?25h row['[?25l[?25haltitude[?25l[?25h'][?25l[?25h
    
    #[?25l[?25h Convert degrees[?25l[?25h to radians[?25l[?25h
    lat_[?25l[?25hrad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hat)[?25l[?25h
    lon[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hon)[?25l[?25h
    lat[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hat_[?25l[?25hobs)[?25l[?25h
    lon[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hon_[?25l[?25hobs)[?25l[?25h
    
    # Calculate[?25l[?25h dN[?25l[?25h, d[?25l[?25hE in[?25l[?25h meters using[?25l[?25h flat approximation[?25l[?25h
    dN[?25l[?25h = R[?25l[?25h * ([?25l[?25hlat_[?25l[?25hrad -[?25l[?25h lat_[?25l[?25hobs_[?25l[?25hrad)[?25l[?25h
    d[?25l[?25hE =[?25l[?25h R *[?25l[?25h math.cos[?25l[?25h(lat[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h) *[?25l[?25h (lon[?25l[?25h_rad[?25l[?25h - lon[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h)[?25l[?25h
    dU[?25l[?25h = alt[?25l[?25h - alt[?25l[?25h_obs[?25l[?25h
    
    d =[?25l[?25h math[?25l[?25h.sqrt(d[?25l[?25hE**[?25l[?25h2 +[?25l[?25h dN[?25l[?25h**2[?25l[?25h)[?25l[?25h
    
    d[?25l[?25hE_list[?25l[?25h.append(d[?25l[?25hE)[?25l[?25h
    d[?25l[?25hN_list[?25l[?25h.append(d[?25l[?25hN)[?25l[?25h
    d[?25l[?25hU_list[?25l[?25h.append(d[?25l[?25hU)[?25l[?25h
    d[?25l[?25h_list.append[?25l[?25h(d)[?25l[?25h

# Calculate[?25l[?25h expected drop[?25l[?25h
expected[?25l[?25h_drop[?25l[?25h = [[?25l[?25h -[?25l[?25h ([?25l[?25hd**[?25l[?25h2)[?25l[?25h / ([?25l[?25h2*[?25l[?25hR)[?25l[?25h for d[?25l[?25h in d[?25l[?25h_list][?25l[?25h

# Plot[?25l[?25h
plt.figure[?25l[?25h(fig[?25l[?25hsize=([?25l[?25h10,[?25l[?25h6))[?25l[?25h
plt.plot[?25l[?25h(d_list[?25l[?25h, d[?25l[?25hU_list[?25l[?25h, '[?25l[?25ho',[?25l[?25h label='[?25l[?25hMeas[?25l[?25hured height[?25l[?25h relative to[?25l[?25h observer')[?25l[?25h
plt.plot[?25l[?25h(d_list[?25l[?25h, expected[?25l[?25h_drop[?25l[?25h, '-[?25l[?25h', label[?25l[?25h='Expected[?25l[?25h curvature[?25l[?25h drop[?25l[?25h')
plt[?25l[?25h.xlabel('[?25l[?25hDistance from[?25l[?25h observer ([?25l[?25hm)[?25l[?25h')
plt[?25l[?25h.ylabel('[?25l[?25hHeight relative[?25l[?25h to observer[?25l[?25h (m[?25l[?25h)')[?25l[?25h
plt.[?25l[?25hlegend()[?25l[?25h
plt.title[?25l[?25h('Earth[?25l[?25h Cur[?25l[?25hvature[?25l[?25h Verification[?25l[?25h')
plt[?25l[?25h.grid([?25l[?25hTrue)[?25l[?25h
plt.show[?25l[?25h()

This[?25l[?25h code should[?25l[?25h plot the[?25l[?25h data and[?25l[?25h the[?25l[?25h expected curve[?25l[?25h.

But[?25l[?25h note:[?25l[?25h this assumes[?25l[?25h the points[?25l[?25h are close[?25l[?25h enough[?25l[?25h for[?25l[?25h the flat[?25l[?25h approximation.[?25l[?25h If[?25l[?25h points[?25l[?25h are far[?25l[?25h, we[?25l[?25h should[?25l[?25h use great[?25l[?25h circle distance[?25l[?25h.

Alternatively[?25l[?25h, we[?25l[?25h can calculate[?25l[?25h the great[?25l[?25h circle distance[?25l[?25h using the[?25l[?25h havers[?25l[?25hine formula[?25l[?25h.

Let[?25l[?25h's update[?25l[?25h the code[?25l[?25h to use[?25l[?25h ha[?25l[?25hversine[?25l[?25h for[?25l[?25h distance calculation[?25l[?25h.

H[?25l[?25haversine[?25l[?25h formula[?25l[?25h:
a[?25l[?25h = sin[?25l[?25h¬≤([?25l[?25hŒîœÜ[?25l[?25h/2[?25l[?25h) +[?25l[?25h cos([?25l[?25hœÜ1[?25l[?25h) *[?25l[?25h cos([?25l[?25hœÜ2[?25l[?25h) *[?25l[?25h sin¬≤[?25l[?25h(Œî[?25l[?25hŒª/[?25l[?25h2)[?25l[?25h
c =[?25l[?25h 2[?25l[?25h * at[?25l[?25han2[?25l[?25h(s[?25l[?25hqrt(a[?25l[?25h), sqrt[?25l[?25h(1[?25l[?25h-a))[?25l[?25h
d =[?25l[?25h R *[?25l[?25h c[?25l[?25h

But[?25l[?25h this gives[?25l[?25h the great[?25l[?25h circle distance[?25l[?25h on[?25l[?25h the sphere[?25l[?25h,[?25l[?25h not the[?25l[?25h straight line[?25l[?25h distance.[?25l[?25h For[?25l[?25h height[?25l[?25h difference[?25l[?25h, we[?25l[?25h need the[?25l[?25h straight line[?25l[?25h distance?[?25l[?25h Or should[?25l[?25h we use[?25l[?25h the great[?25l[?25h circle distance[?25l[?25h for d[?25l[?25h?[?25l[?25h

The drop[?25l[?25h formula[?25l[?25h d[?25l[?25h^2[?25l[?25h/(2[?25l[?25hR)[?25l[?25h is based[?25l[?25h on straight[?25l[?25h line distance[?25l[?25h. But[?25l[?25h if we[?25l[?25h use great[?25l[?25h circle distance[?25l[?25h, it[?25l[?25h might[?25l[?25h be different[?25l[?25h.[?25l[?25h However,[?25l[?25h for small[?25l[?25h d,[?25l[?25h they[?25l[?25h are similar[?25l[?25h.

To[?25l[?25h be precise[?25l[?25h, we[?25l[?25h should calculate[?25l[?25h the straight[?25l[?25h line distance[?25l[?25h in[?25l[?25h 3D[?25l[?25h space[?25l[?25h.

Let[?25l[?25h's calculate[?25l[?25h the straight[?25l[?25h line distance[?25l[?25h between the[?25l[?25h observer and[?25l[?25h point in[?25l[?25h E[?25l[?25hCEF[?25l[?25h coordinates.[?25l[?25h

Steps:[?25l[?25h
1.[?25l[?25h Convert each[?25l[?25h point to[?25l[?25h ECE[?25l[?25hF.[?25l[?25h
2.[?25l[?25h Calculate the[?25l[?25h Euclidean[?25l[?25h distance between[?25l[?25h observer and[?25l[?25h point.[?25l[?25h

But this[?25l[?25h distance will[?25l[?25h include the[?25l[?25h height difference[?25l[?25h, so[?25l[?25h we need[?25l[?25h the[?25l[?25h horizontal distance[?25l[?25h.[?25l[?25h We[?25l[?25h can project[?25l[?25h the vector[?25l[?25h onto the[?25l[?25h local horizontal[?25l[?25h plane.[?25l[?25h

This[?25l[?25h is[?25l[?25h getting complex[?25l[?25h. For[?25l[?25h simplicity,[?25l[?25h we[?25l[?25h'll use[?25l[?25h the flat[?25l[?25h approximation for[?25l[?25h dE[?25l[?25h and d[?25l[?25hN,[?25l[?25h and then[?25l[?25h d =[?25l[?25h sqrt(d[?25l[?25hE^[?25l[?25h2 +[?25l[?25h dN[?25l[?25h^2[?25l[?25h).[?25l[?25h

Given[?25l[?25h that[?25l[?25h the points[?25l[?25h are likely[?25l[?25h close,[?25l[?25h this should[?25l[?25h be fine[?25l[?25h.

I[?25l[?25h'll go[?25l[?25h with the[?25l[?25h flat approximation[?25l[?25h.[?25l[?25h

Now[?25l[?25h, you[?25l[?25h can[?25l[?25h run this[?25l[?25h code with[?25l[?25h your dataset[?25l[?25h to see[?25l[?25h the curvature[?25l[?25h.

If[?25l[?25h the[?25l[?25h Earth[?25l[?25h is flat[?25l[?25h, the[?25l[?25h measured height[?25l[?25h should be[?25l[?25h constant,[?25l[?25h and the[?25l[?25h expected curve[?25l[?25h should be[?25l[?25h zero[?25l[?25h. If[?25l[?25h curved,[?25l[?25h the measured[?25l[?25h height[?25l[?25h should follow[?25l[?25h the expected[?25l[?25h curve if[?25l[?25h the terrain[?25l[?25h is flat[?25l[?25h.

Let[?25l[?25h's hope[?25l[?25h the[?25l[?25h dataset is[?25l[?25h over water[?25l[?25h or flat[?25l[?25h land.[?25l[?25h

I[?25l[?25h'll now[?25l[?25h provide[?25l[?25h the code[?25l[?25h.[?25l[?25h curve[?25l[?25h_[?25l[?25hver[?25l[?25hification.py[?25l[?25h
curve[?25l[?25h_ver[?25l[?25hification.py[?25l[?25h
```[?25l[?25hpython[?25l[?25h
import pandas[?25l[?25h as pd[?25l[?25h
import[?25l[?25h math[?25l[?25h
import matplotlib[?25l[?25h.pyplot as[?25l[?25h plt[?25l[?25h

# Earth[?25l[?25h radius in[?25l[?25h meters[?25l[?25h
R =[?25l[?25h 637[?25l[?25h8100[?25l[?25h

#[?25l[?25h Read data[?25l[?25h
data[?25l[?25h = pd[?25l[?25h.read_csv[?25l[?25h('data[?25l[?25h.csv')[?25l[?25h

# Assume[?25l[?25h first point[?25l[?25h is observer[?25l[?25h
lat[?25l[?25h_obs[?25l[?25h = data[?25l[?25h.iloc[?25l[?25h[0[?25l[?25h]['latitude[?25l[?25h']
lon[?25l[?25h_obs[?25l[?25h = data[?25l[?25h.iloc[?25l[?25h[0[?25l[?25h]['long[?25l[?25hitude'][?25l[?25h
alt_[?25l[?25hobs =[?25l[?25h data.il[?25l[?25hoc[[?25l[?25h0]['[?25l[?25haltitude[?25l[?25h']

d[?25l[?25hE_list[?25l[?25h = [][?25l[?25h
dN[?25l[?25h_list =[?25l[?25h []
d[?25l[?25hU_list[?25l[?25h = [][?25l[?25h
d_list[?25l[?25h = [][?25l[?25h

for i[?25l[?25h, row[?25l[?25h in data[?25l[?25h.iterrows[?25l[?25h():[?25l[?25h
    lat =[?25l[?25h row['[?25l[?25hlatitude'][?25l[?25h
    lon[?25l[?25h = row[?25l[?25h['long[?25l[?25hitude'][?25l[?25h
    alt[?25l[?25h = row[?25l[?25h['alt[?25l[?25hitude'][?25l[?25h
    
    # Convert[?25l[?25h degrees to[?25l[?25h radians[?25l[?25h
    lat[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hat)[?25l[?25h
    lon[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hon)[?25l[?25h
    lat[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hat_[?25l[?25hobs)[?25l[?25h
    lon[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h = math[?25l[?25h.rad[?25l[?25hians(l[?25l[?25hon_[?25l[?25hobs)[?25l[?25h
    
    # Calculate[?25l[?25h dN[?25l[?25h, d[?25l[?25hE in[?25l[?25h meters using[?25l[?25h flat approximation[?25l[?25h
    dN[?25l[?25h = R[?25l[?25h * ([?25l[?25hlat_[?25l[?25hrad -[?25l[?25h lat_[?25l[?25hobs_[?25l[?25hrad)[?25l[?25h
    d[?25l[?25hE =[?25l[?25h R *[?25l[?25h math.cos[?25l[?25h(lat[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h) *[?25l[?25h (lon[?25l[?25h_rad[?25l[?25h - lon[?25l[?25h_obs[?25l[?25h_rad[?25l[?25h)[?25l[?25h
    dU[?25l[?25h = alt[?25l[?25h - alt[?25l[?25h_obs[?25l[?25h
    
    d =[?25l[?25h math.sqrt[?25l[?25h(dE[?25l[?25h**2[?25l[?25h + d[?25l[?25hN**[?25l[?25h2)[?25l[?25h
    
    dE[?25l[?25h_list.append[?25l[?25h(dE[?25l[?25h)[?25l[?25h
    dN[?25l[?25h_list.append[?25l[?25h(dN[?25l[?25h)[?25l[?25h
    dU[?25l[?25h_list.append[?25l[?25h(dU[?25l[?25h)[?25l[?25h
    d_list[?25l[?25h.append(d[?25l[?25h)

#[?25l[?25h Calculate expected[?25l[?25h drop due[?25l[?25h to curvature[?25l[?25h
expected[?25l[?25h_drop[?25l[?25h = [[?25l[?25h - ([?25l[?25hd**[?25l[?25h2)[?25l[?25h / ([?25l[?25h2*[?25l[?25hR)[?25l[?25h for d[?25l[?25h in d[?25l[?25h_list][?25l[?25h

# Plot[?25l[?25h
plt[?25l[?25h.figure(f[?25l[?25higsize[?25l[?25h=(10[?25l[?25h,6[?25l[?25h))
plt[?25l[?25h.plot(d[?25l[?25h_list,[?25l[?25h dU[?25l[?25h_list,[?25l[?25h 'o[?25l[?25h', label[?25l[?25h='Meas[?25l[?25hured height[?25l[?25h relative to[?25l[?25h observer')[?25l[?25h
plt.plot[?25l[?25h(d_list[?25l[?25h, expected[?25l[?25h_drop[?25l[?25h, '-[?25l[?25h', label[?25l[?25h='Expected[?25l[?25h curvature drop[?25l[?25h')
plt[?25l[?25h.xlabel('[?25l[?25hDistance from[?25l[?25h observer ([?25l[?25hm)[?25l[?25h')
plt[?25l[?25h.ylabel('[?25l[?25hHeight relative[?25l[?25h to observer[?25l[?25h (m[?25l[?25h)')[?25l[?25h
plt.[?25l[?25hlegend()[?25l[?25h
plt.title[?25l[?25h('Earth[?25l[?25h Curv[?25l[?25hature Verification[?25l[?25h')
plt[?25l[?25h.grid([?25l[?25hTrue)[?25l[?25h
plt.show[?25l[?25h()

#[?25l[?25h Also[?25l[?25h plot[?25l[?25h the data[?25l[?25h points on[?25l[?25h a map[?25l[?25h
plt[?25l[?25h.figure(f[?25l[?25higsize[?25l[?25h=(10[?25l[?25h,6[?25l[?25h))
plt[?25l[?25h.plot[?25l[?25h(dE[?25l[?25h_list,[?25l[?25h dN[?25l[?25h_list,[?25l[?25h 'o[?25l[?25h-[?25l[?25h')
plt[?25l[?25h.xlabel('[?25l[?25hEast ([?25l[?25hm)[?25l[?25h')
plt[?25l[?25h.ylabel('[?25l[?25hNorth ([?25l[?25hm)[?25l[?25h')
plt[?25l[?25h.title('[?25l[?25hMap of[?25l[?25h points relative[?25l[?25h to observer[?25l[?25h')
plt[?25l[?25h.grid([?25l[?25hTrue)[?25l[?25h
plt.[?25l[?25haxis('[?25l[?25hequal')[?25l[?25h
plt.show[?25l[?25h()[?25l[?25h
```

This[?25l[?25h code will[?25l[?25h plot two[?25l[?25h graphs[?25l[?25h: one[?25l[?25h for[?25l[?25h height vs[?25l[?25h distance,[?25l[?25h and one[?25l[?25h for the[?25l[?25h map of[?25l[?25h points relative[?25l[?25h to observer[?25l[?25h.

Run[?25l[?25h this[?25l[?25h code with[?25l[?25h your dataset[?25l[?25h to see[?25l[?25h the curvature[?25l[?25h.

If[?25l[?25h the Earth[?25l[?25h is curved[?25l[?25h, the[?25l[?25h measured height[?25l[?25h should follow[?25l[?25h the expected[?25l[?25h drop curve[?25l[?25h. If[?25l[?25h flat[?25l[?25h, it[?25l[?25h should be[?25l[?25h constant.[?25l[?25h

Note[?25l[?25h: This[?25l[?25h assumes the[?25l[?25h terrain is[?25l[?25h flat.[?25l[?25h If the[?25l[?25h terrain is[?25l[?25h not flat[?25l[?25h, the[?25l[?25h measured height[?25l[?25h will include[?25l[?25h terrain[?25l[?25h variations.[?25l[?25h

I hope[?25l[?25h this helps[?25l[?25h in[?25l[?25h verifying[?25l[?25h the curvature[?25l[?25h.[?25l[?25h[?25l[?25h

[?25l[?25h